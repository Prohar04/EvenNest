{% load static %}
{% load cart_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}EventNest{% endblock %}</title>
    <!-- Preload critical assets -->
    <link rel="preload" href="{% static 'css/style.css' %}" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" as="style">
    <!-- Load CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/modern-design.css' %}">
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <!-- Load JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
    <style>
        /* Animated gradient background applied to body */
        body {
            background: linear-gradient(
                -45deg,
                #667eea,
                #764ba2,
                #4facfe,
                #00f2fe
            );
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            position: relative;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(79, 172, 254, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(250, 112, 154, 0.1) 0%, transparent 50%);
            pointer-events: none;
            animation: floatingShapes 20s ease-in-out infinite;
            z-index: -1;
        }

        main {
            position: relative;
            z-index: 1;
        }

        main .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-top: 2rem !important;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes floatingShapes {
            0%, 100% { transform: translate(0, 0); opacity: 0.5; }
            25% { transform: translate(30px, -50px); opacity: 0.7; }
            50% { transform: translate(-60px, 30px); opacity: 0.5; }
            75% { transform: translate(40px, 60px); opacity: 0.6; }
        }
    </style>
</head>
<body>
    {% block auth_wrapper %}        {% block navbar %}
            {% include 'navbar.html' %}
        {% endblock %}
        
        <main>
            <div class="container mt-4">
                {% block content %}{% endblock %}
            </div>
        </main>

        {% block footer %}
            {% include 'footer.html' %}
        {% endblock %}
    {% endblock %}

    {% block extra_js %}{% endblock %}
    
    <!-- Performance optimizations -->
    <script>
        // Lazy load images
        if ('IntersectionObserver' in window) {
            const images = document.querySelectorAll('img[data-src]');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                        imageObserver.unobserve(img);
                    }
                });
            });
            images.forEach(img => imageObserver.observe(img));
        }
    </script>
</body>
</html>